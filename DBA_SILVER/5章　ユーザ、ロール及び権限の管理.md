# 管理者ユーザ(SYS、SYSTEM)
事前作成済みの管理者ユーザ
## SYSユーザ
データベースの起動/停止を含むすべての権限を持つユーザ
・Oracleデータディクショナリの所有者
・SYSDBA権限を持つ
・DBAロールを持つ(ユーザ作成権限など)
・削除不可
## SYSTEMユーザ
データベースの起動/停止はできないが、その他の権限を持つユーザ
・DBAロールを持つ(ユーザ作成権限など)
・削除不可
## ユーザ作成(CREATE USER権限が必要)
ユーザ作成例：
CREATE USER user01                                  -- ユーザー名
  IDENTIFIED BY Password123                 -- 認証方法：パスワード
  DEFAULT TABLESPACE tbs01                 -- デフォルト表領域
  TEMPORARY TABLESPACE temp          -- 一時表領域
  QUOTA 10M ON tbs01                               -- tbs01 表領域に10MB使用可能
  QUOTA UNLIMITED ON tbs02                -- tbs02 表領域に無制限で使用可能
  PROFILE DEFAULT                                      -- プロファイル：DEFAULT を適用
  PASSWORD EXPIRE                                    -- パスワード：期限切れ状態で作成
  ACCOUNT UNLOCK;                                   -- アカウント：アンロック状態（使用可能）
# ユーザ削除



# 権限
## システム権限とオブジェクト権限

| 名前       | 用途                       | できること           |
| -------- | ------------------------ | --------------- |
| システム権限   | データベースに対して操作を許可する        | CREATE TABLE　など |
| オブジェクト権限 | 他のユーザが所有するオブジェクトの操作を許可する | SELECT　など       |
## 権限の付与
### GRANT ANY PRIVILEGEシステム権限とGRANT ANY OBJECT PRIVILEGEシステム権限

この2つが付与されているとシステム権限とオブジェクト権限を他のユーザに付与できる
→SYSとSYSTEMユーザが持っている
### WITH ADMIN OPTION句とWITH GRANT OPTION句

それぞれシステム権限、オブジェクト権限を付与できる句

# ロール

複数の権限をまとめて付与・管理する仕組み

ロールをロールに付与することができる
→そのロールを付与すると2つのロールを付与される

`GRANT role_A TO role_B;`
`GRANT role_B TO user01;`

## ロールの有効無効切り替え

GRANT 文で付与したロールは、ログイン時に自動で有効

パスワード保護付きロールはログイン時に無効
→SET ROLE文で有効化可能(セッションのみ)

`CREATE ROLE secure_role IDENTIFIED BY mypass;`
`GRANT secure_role TO user01;`

このセッション中のみ secure_role が有効になる

# DBMS_PRIVILEGE_CAPTURE

不要なユーザに権限が付与されていないかを見る分析機能

分析対象は以下
①全データベース：SYSユーザ以外の全ユーザ
②ロール：指定されたロールを持つユーザ
③コンテキスト：指定した評価式をクリアするユーザ
④ロールとコンテキスト：その2つをクリアするユーザ

# 一般ユーザの認証方法
## データベース認証

CREATE USER user01                                  -- ユーザー名：user01
  IDENTIFIED BY Password123                 -- パスワード：Password123
  ・・・

ユーザ作成の時にパスワードを指定し、そのパスワードを入力して認証

`sqlplus user01/Password123`
で接続開始

## OS認証

OS(データベースサーバー)に接続できるなら、
そのままデータベースに接続できるという認証

⓪OS認証で使用するユーザを作成
※このユーザー名の前につくops$はOS_AUTHENT_PREFIXに定義しているものを使用
`CREATE USER ops$u2 IDENTIFIED EXTERNALLY;`

①u2ユーザでOSに接続
`ssh u2@server01`

②データベースにも接続できるのでユーザ名パスワードはいらない
`sqlplus /`

# クオータ

表領域の記憶割り当て制限

`QUOTA 10M ON tbs01` tbs01に最大10Mバイト

`QUOTA UNLIMITED ON tbs02` tbs02に表領域に空きがある限り無制限に使用可能

※一時表領域、UNDO表領域にはクオータは割り当てられない
※遅延セグメント作成が有効ならクオータが割り当てられていない表領域にテーブルを作成できるがインサート時にエラーが出る

## UNLIMITED TABLESPACEシステム権限
→すべての表領域に無制限に記憶域を割り当てることができる権限
※ロールには付与できない

# 管理権限を持つユーザの接続

## OS認証

OSにログインしたユーザが特定のグループ(dba,oper)に所属している場合認証する
## パスワードファイル認証

パスワードファイルに保管されているユーザ名と暗号化されたパスワードを用いて認証
デフォルトパス：<ORACLE_HOME>/dba/orapw<ORACLE_SID>

また、REMOTE_LOGIN_PASSWORDFILE初期化パラメータが exclusive か shared である必要がある

# セキュリティを高めるための設定5選

①監査機能を有効に
②不要な権限を付与しない
③不要なユーザアカウントはロックする
④十分に複雑なパスワードを使用する
⑤危険な初期化パラメータを非デフォルト値にしない