# ADR（自動診断リポジトリ）

## 1. 概要
ADR（Automatic Diagnostic Repository）は、Oracleデータベースの診断情報を集中管理するための仕組みです。

### 1.1 主な特徴
- データベースの起動状態に関係なくアクセス可能
- 複数のOracle製品のログを統合管理
- 診断情報の自動収集と管理
- 問題発生時の原因究明をサポート

## 2. ADRの構成

### 2.1 ADRベース
- ADRのルートディレクトリ
- 設定方法：
  - `DIAGNOSTIC_DEST`初期化パラメータで指定
  - 未設定時：
    - `ORACLE_BASE`環境変数の値
    - または`<ORACLE_HOME>/log`

### 2.2 ADRホーム
- ADRベース配下に作成される製品インスタンスごとのディレクトリ
- 各インスタンスの診断情報を管理

## 3. 診断情報の種類

### 3.1 アラートログ
- 場所：`<ADR_HOME>/trace/alert_<ORACLE_SID>.log`
- 記録される情報：
  - インスタンスの起動・終了
  - デフォルト以外の初期化パラメータ
  - 内部エラー
  - ブロック障害エラー
  - デッドロックエラー
  - 管理コマンドの実行
  - ジョブ実行エラー

### 3.2 プロセストレースファイル
- 場所：`<ADR_HOME>/trace/`
- ファイル名形式：`<インスタンスSID>_<プロセス名>_<OSプロセス番号>.trc`
- 用途：
  - プロセス固有の診断情報
  - エラー発生時の詳細情報
  - パフォーマンス問題の分析

## 4. ADRの確認方法

### 4.1 コマンド例
```sql
-- ADRの場所を確認
SHOW PARAMETER DIAGNOSTIC_DEST;

-- V$DIAG_INFOビューから詳細情報を取得
SELECT * FROM V$DIAG_INFO;
```

## 5. ADRの利点

### 5.1 集中管理
- すべての診断情報を一箇所で管理
- 複数インスタンスのログを統一的に管理

### 5.2 可用性
- データベースが停止していてもアクセス可能
- 問題発生時の迅速な対応が可能

### 5.3 拡張性
- 複数のOracle製品のログを統合管理
- 新しい診断情報の追加が容易

### 5.4 自動管理
- ログのローテーション
- 古いログの自動削除
- ディスク容量の自動管理
